<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Setup Instructions - POS</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:#f5f5f5;color:#333;padding:20px}
    .container{max-width:900px;margin:0 auto}
    .header{background:linear-gradient(135deg, #667eea 0%, #764ba2 100%);color:white;padding:2rem;border-radius:12px;margin-bottom:2rem;box-shadow:0 4px 12px rgba(0,0,0,0.1)}
    h1{font-size:2rem;margin-bottom:0.5rem}
    .subtitle{font-size:1rem;opacity:0.9}
    section{background:white;padding:25px;border-radius:10px;margin-bottom:20px;box-shadow:0 2px 8px rgba(0,0,0,0.1)}
    h2{color:#667eea;margin-bottom:15px;padding-bottom:10px;border-bottom:2px solid #667eea}
    h3{color:#333;margin:20px 0 10px;font-size:1.1rem}
    p{margin-bottom:12px;line-height:1.6;color:#555}
    ul,ol{margin:10px 0 15px 25px;line-height:1.8}
    li{margin-bottom:8px;color:#555}
    code{background:#f0f0f0;padding:2px 6px;border-radius:4px;font-family:'Courier New',monospace;font-size:0.9rem;color:#d63384}
    .info-box{background:#e3f2fd;border-left:4px solid #2196f3;padding:15px;margin:15px 0;border-radius:4px}
    .warning-box{background:#fff3e0;border-left:4px solid #ff9800;padding:15px;margin:15px 0;border-radius:4px}
    .success-box{background:#e8f5e9;border-left:4px solid #4caf50;padding:15px;margin:15px 0;border-radius:4px}
    table{width:100%;border-collapse:collapse;margin:15px 0;font-size:0.9rem}
    th{background:#667eea;color:white;padding:12px;text-align:left}
    td{padding:12px;border-bottom:1px solid #eee}
    tr:hover{background:#f8f9fa}
    .back-btn{display:inline-block;background:#667eea;color:white;padding:12px 24px;text-decoration:none;border-radius:8px;margin-bottom:20px;transition:all 0.3s}
    .back-btn:hover{background:#764ba2;transform:translateY(-2px);box-shadow:0 4px 8px rgba(0,0,0,0.2)}
    strong{color:#333}
  </style>
</head>
<body>
  <div class="container">
    <a href="admin.html" class="back-btn">‚Üê Back to Admin</a>
    
    <div class="header">
      <h1>üîß Setup Instructions</h1>
      <div class="subtitle">Complete guide to configure your POS system</div>
    </div>

    <section>
      <h2>üì° Printer Connection Overview</h2>
      
      <div class="info-box">
        <strong>‚ö° Quick Info: Which Mode Works Where?</strong>
      </div>
      
      <table>
        <thead>
          <tr>
            <th>Deployment</th>
            <th>Connection Type</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Local <code>node server.js</code></td>
            <td>ePOS SDK (8043)</td>
            <td>‚úÖ Works</td>
          </tr>
          <tr style="background:#e8f5e9;">
            <td><strong>Cloudflare Pages</strong></td>
            <td><strong>ePOS SDK (8043)</strong></td>
            <td><strong>‚úÖ Recommended</strong></td>
          </tr>
          <tr style="background:#ffebee;">
            <td>Cloudflare Pages</td>
            <td>TCP (9100)</td>
            <td>‚ùå Not supported</td>
          </tr>
        </tbody>
      </table>
      
      <div class="warning-box">
        <strong>Important:</strong> This POS system uses <strong>Epson ePOS SDK</strong> for browser-to-printer communication on port <strong>8043</strong>. 
        Make sure your printers have ePOS enabled!
      </div>
    </section>

    <section>
      <h2>üñ®Ô∏è Printer Requirements</h2>
      
      <h3>Compatible Printers</h3>
      <ul>
        <li>Epson TM-series thermal printers (TM-T20, TM-T82, TM-T88, etc.)</li>
        <li>Printer must have <strong>Ethernet or WiFi network interface</strong></li>
        <li>Printer must support <strong>ePOS SDK</strong> (most modern Epson printers do)</li>
      </ul>

      <h3>Network Requirements</h3>
      <ul>
        <li>Printer must be on the <strong>same local network</strong> as staff devices</li>
        <li>Printer must have a <strong>static IP address</strong> (e.g., 192.168.1.100)</li>
        <li>Browser must access system via <strong>HTTPS</strong> for ePOS to work</li>
      </ul>

      <div class="info-box">
        <strong>Tip:</strong> Set static IP in your router's DHCP settings or in the printer's network configuration.
      </div>
    </section>

    <section>
      <h2>üîß Printer Configuration Steps</h2>
      
      <h3>Step 1: Enable ePOS on Printer</h3>
      <ol>
        <li>Print the printer's network configuration page (usually by holding a button on printer)</li>
        <li>Find the printer's IP address (e.g., 192.168.1.100)</li>
        <li>Open a web browser on same network</li>
        <li>Go to <code>http://[printer-ip]</code> (e.g., http://192.168.1.100)</li>
        <li>Login (default: username <code>EPSON</code>, password <code>EPSON</code> or blank)</li>
        <li>Navigate to <strong>Configuration ‚Üí ePOS Settings</strong></li>
        <li>Enable <strong>ePOS</strong> and set port to <strong>8043</strong></li>
        <li>Enable <strong>Use SSL/TLS</strong> if available</li>
        <li>Click <strong>Apply</strong> and reboot printer if prompted</li>
      </ol>

      <h3>Step 2: Configure POS System</h3>
      <ol>
        <li>Go to <a href="admin.html">Admin Panel</a></li>
        <li>Scroll to <strong>Printer Configuration</strong> section</li>
        <li>Enter <strong>Food Printer IP</strong> (e.g., 192.168.1.100)</li>
        <li>Enter <strong>Drink Printer IP</strong> (can be same as food printer or different)</li>
        <li>Click <strong>Save Configuration</strong></li>
        <li>Click <strong>Test Print</strong> to verify connection</li>
      </ol>

      <div class="success-box">
        <strong>Success!</strong> If test print works, you're all set! Orders placed on <a href="order.html">order.html</a> will now print to the configured printers.
      </div>

      <h3>Step 3: Test End-to-End</h3>
      <ol>
        <li>Open <a href="order.html">Order Page (order.html)</a> on a staff device</li>
        <li>Select a table</li>
        <li>Add some food and drink items</li>
        <li>Click <strong>Preview Tickets</strong> to review</li>
        <li>Click <strong>Submit Order</strong></li>
        <li>Check that tickets print correctly to food/drink printers</li>
        <li>Go to <a href="admin.html">Admin Panel</a> to see pending order</li>
        <li>Mark the order as paid when complete</li>
      </ol>
    </section>

    <section>
      <h2>üö® Troubleshooting</h2>
      
      <h3>Test print fails with "Connection timeout"</h3>
      <ul>
        <li><strong>Check:</strong> Printer and device are on same network</li>
        <li><strong>Check:</strong> IP address is correct (ping the IP from terminal)</li>
        <li><strong>Check:</strong> ePOS is enabled on printer (port 8043)</li>
        <li><strong>Check:</strong> Firewall not blocking port 8043</li>
        <li><strong>Check:</strong> Browser console for specific error messages</li>
      </ul>

      <h3>Test print works but order prints don't work</h3>
      <ul>
        <li><strong>Check:</strong> Printer configuration is saved correctly</li>
        <li><strong>Check:</strong> Browser console for errors when submitting order</li>
        <li><strong>Check:</strong> Food/drink printer IPs are correct</li>
        <li><strong>Try:</strong> Clear browser cache and reload page</li>
      </ul>

      <h3>Only one ticket prints when multiple items ordered</h3>
      <ul>
        <li><strong>Check:</strong> Browser console for print task logs</li>
        <li><strong>Check:</strong> Menu items have correct <code>printer</code> property (food/drink)</li>
        <li><strong>Try:</strong> Test with single item first, then multiple</li>
        <li><strong>Note:</strong> System prints 1 ticket per item quantity (qty=3 ‚Üí 3 tickets)</li>
      </ul>

      <h3>Characters overlap on printed ticket</h3>
      <ul>
        <li><strong>Fixed:</strong> Latest version uses proper line breaks (<code>\n</code>)</li>
        <li><strong>Try:</strong> Refresh page to get latest code</li>
        <li><strong>Check:</strong> Printer is using ESC/POS mode (not OPOS)</li>
      </ul>

      <div class="info-box">
        <strong>Still having issues?</strong> Check the <a href="https://download.epson-biz.com/modules/pos/index.php?page=prod&pcat=3&pid=5" target="_blank">Epson ePOS SDK documentation</a> or contact your IT support.
      </div>
    </section>

    <section>
      <h2>üì± Deployment Options</h2>
      
      <h3>Option A: Cloudflare Pages (Current Setup)</h3>
      <div class="success-box">
        <strong>‚úÖ Currently Active</strong>
      </div>
      <ul>
        <li><strong>URL:</strong> <code>https://posprint.hklionkitchen.co.uk</code></li>
        <li><strong>Cost:</strong> Free</li>
        <li><strong>Setup:</strong> Already configured and deployed</li>
        <li><strong>Updates:</strong> Automatic from GitHub main branch</li>
        <li><strong>Requirements:</strong> Printers must have ePOS enabled</li>
      </ul>

      <h3>Option B: Local Node.js Server</h3>
      <ul>
        <li><strong>URL:</strong> <code>http://localhost:3000</code></li>
        <li><strong>Cost:</strong> Free</li>
        <li><strong>Setup:</strong> Run <code>npm install</code> then <code>node server.js</code></li>
        <li><strong>Use case:</strong> Testing, development, or if ePOS not available</li>
        <li><strong>Note:</strong> Only accessible on local network</li>
      </ul>

      <h3>Option C: Cloud VM Deployment</h3>
      <ul>
        <li><strong>Platforms:</strong> DigitalOcean, AWS, Google Cloud, Azure</li>
        <li><strong>Cost:</strong> $5-20/month</li>
        <li><strong>Setup:</strong> Deploy Node.js server on VM, expose via public IP</li>
        <li><strong>Security:</strong> Use HTTPS (SSL certificate via Let's Encrypt)</li>
        <li><strong>Use case:</strong> Full control, can support TCP and ePOS</li>
      </ul>
    </section>

    <section>
      <h2>üìö Additional Resources</h2>
      
      <ul>
        <li><a href="https://download.epson-biz.com/modules/pos/index.php?page=prod&pcat=3&pid=5" target="_blank">Epson ePOS SDK Download & Docs</a></li>
        <li><a href="https://reference.epson-biz.com/modules/ref_epos_sdk_js/index.php?content_id=26" target="_blank">ePOS JavaScript API Reference</a></li>
        <li><a href="README.md">Project README</a></li>
        <li><a href="admin.html">Admin Panel</a></li>
        <li><a href="order.html">Order Page</a></li>
      </ul>
    </section>

    <a href="admin.html" class="back-btn">‚Üê Back to Admin</a>
  </div>
</body>
</html>
